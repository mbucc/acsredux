#! /bin/sh -e
# Re-run tests when notified of a file change or addition.

[ "$1" = "x" ] && ROWS=$1 || ROWS=10

trap exit SIGINT
while :
do
  find src/ | entr -cd sh -c "make -s JUNIT_DETAILS=none SKIP_FMT=Y 2>&1 | head -n $ROWS"
  sleep 0.1
done
